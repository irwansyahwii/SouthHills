// Generated by CoffeeScript 1.9.2
(function() {
  var GalleryScreen,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  GalleryScreen = (function() {
    function GalleryScreen() {
      this.play = bind(this.play, this);
      this.init = bind(this.init, this);
      this.relayout = bind(this.relayout, this);
      this.onLargeImageViewDoubleTapped = bind(this.onLargeImageViewDoubleTapped, this);
      this.raiseOnDoubleTapped = bind(this.raiseOnDoubleTapped, this);
      this.onThumbImageClicked = bind(this.onThumbImageClicked, this);
      var i, imgInfo, j, thumb_image_wrapper;
      this.view = Ti.UI.createView();
      this.large_scroll_view = Ti.UI.createScrollableView();
      this.images = [];
      this.large_images = [];
      this.thumb_images = [];
      this.thumb_scroll_view = Ti.UI.createScrollView({
        height: 268 / 2,
        contentWidth: "auto",
        contentHeight: "auto"
      });
      for (i = j = 1; j <= 10; i = ++j) {
        imgInfo = {
          large_image: Ti.UI.createImageView({
            image: "Gallery-Image" + i + ".png"
          }),
          thumb_image: Ti.UI.createButton({
            backgroundImage: "Gallery-Thumb" + i + ".png",
            width: 223 / 2,
            height: 223 / 2,
            image_index: i - 1
          })
        };
        imgInfo.large_image.addEventListener("doubletap", this.onLargeImageViewDoubleTapped);
        imgInfo.thumb_image.addEventListener("click", this.onThumbImageClicked);
        this.images.push(imgInfo);
        this.large_images.push(imgInfo.large_image);
        thumb_image_wrapper = Ti.UI.createView({
          width: imgInfo.thumb_image.width + 30,
          height: imgInfo.thumb_image.height + 10,
          left: (i - 1) * (imgInfo.thumb_image.width + 30 / 2),
          top: 0
        });
        thumb_image_wrapper.add(imgInfo.thumb_image);
        this.thumb_scroll_view.add(thumb_image_wrapper);
        this.thumb_images.push(thumb_image_wrapper);
      }
      this.large_scroll_view.views = this.large_images;
      this.thumb_scroll_view.height = this.thumb_images[0].height;
      this.view.add(this.large_scroll_view);
      this.view.add(this.thumb_scroll_view);
      this.large_scroll_view.left = 0;
      this.large_scroll_view.top = 0;
      this.thumb_scroll_view.left = 0;
      this.onDoubleTapped = null;
    }

    GalleryScreen.prototype.onThumbImageClicked = function(e) {
      return this.large_scroll_view.scrollToView(this.large_scroll_view.views[e.source.image_index]);
    };

    GalleryScreen.prototype.raiseOnDoubleTapped = function() {
      var eventInfo;
      if (this.onDoubleTapped !== null) {
        eventInfo = {
          event_type: "GALLERY",
          event_data: {
            pos: {
              left: this.large_scroll_view.left,
              top: this.large_scroll_view.top
            },
            height: this.large_scroll_view.height,
            width: this.large_scroll_view.width,
            current_image_index: this.large_scroll_view.currentPage
          }
        };
        return this.onDoubleTapped(eventInfo);
      }
    };

    GalleryScreen.prototype.onLargeImageViewDoubleTapped = function() {
      return this.raiseOnDoubleTapped();
    };

    GalleryScreen.prototype.relayout = function() {
      this.large_scroll_view.height = this.view.height - this.thumb_scroll_view.height;
      return this.thumb_scroll_view.top = this.large_scroll_view.top + this.large_scroll_view.height;
    };

    GalleryScreen.prototype.init = function() {
      return this;
    };

    GalleryScreen.prototype.play = function() {};

    return GalleryScreen;

  })();

  module.exports = GalleryScreen;

}).call(this);
